================================================================================
COMPREHENSIVE MORPHOLOGY-AWARE ALIGNMENT ANALYSIS
Comparative Evaluation: RANKING vs TPS Methods
================================================================================

ANALYSIS OVERVIEW
--------------------------------------------------------------------------------
Date: 2025-11-07 16:04:11
Observations CSV: /media/localuser/T7 Shield/colpoptera/morphometrics/inat_hopper_nogodinidae/observations_photos.csv
Results directory: /media/localuser/T7 Shield/colpoptera/morphometrics/inat_hopper_nogodinidae/images/lateral/pairwise_runs_nogodinidae
Output directory: /media/localuser/T7 Shield/colpoptera/morphometrics/inat_hopper_nogodinidae/images/lateral/pairwise_runs_nogodinidae/comparative_analysis_v20

METHODS COMPARED
--------------------------------------------------------------------------------
1. RANKING METHOD (dissimilarity_ranking/)
   - Zero-shot comparison without morphological alignment
   - Uses feature dissimilarity ranking

2. TPS METHOD (dissimilarity_tps_homology/)
   - Morphology-aware comparison with TPS alignment
   - Accounts for shape correspondence via thin-plate splines

DATA SUMMARY
--------------------------------------------------------------------------------
Total unique specimens: 82
Total unique species: 49
Total image pairs analyzed: 1485

FILTERING APPLIED:
  Ã¢â‚¬Â¢ Excluded pairs with incomplete taxonomic IDs
  Ã¢â‚¬Â¢ Incomplete IDs include:
    - Tribe-level only (e.g., 'Colpopterini')
    - Genus-level only (e.g., 'Colpoptera', 'Jamaha')
    - Indeterminate species (e.g., 'sp.', 'indet.')
  Ã¢â‚¬Â¢ Only pairs with full binomial species names are analyzed

Comparison type distribution:
  Same-specimen (different photos): 54
  Intra-specific (different individuals, same species): 13
  Inter-specific (different species): 1418

================================================================================
KEY FINDINGS
================================================================================

1. METHOD COMPARISON (RANKING vs TPS):
--------------------------------------------------------------------------------

SAME-SPECIMEN:
  MEAN:
    RANKING: 0.0000
    TPS:     -0.0000
    Difference: -0.0000 (TPS lower Ã¢Å“â€œ)
    p-value: 1.6257e-10
    Significant: YES
    Effect size (Cohen's d): -8.457

  MEDIAN:
    RANKING: 0.0000
    TPS:     0.0000
    Difference: +0.0000 (identical)
    p-value: 1.0000e+00
    Significant: NO
    Effect size (Cohen's d): 0.000

  P95:
    RANKING: 0.0000
    TPS:     0.0000
    Difference: -0.0000 (TPS lower Ã¢Å“â€œ)
    p-value: 4.1071e-11
    Significant: YES
    Effect size (Cohen's d): -4.949

INTRA-SPECIFIC:
  MEAN:
    RANKING: 0.0559
    TPS:     0.0824
    Difference: +0.0265 (TPS higher Ã¢Å¡Â Ã¯Â¸Â)
    p-value: 2.4414e-04
    Significant: YES
    Effect size (Cohen's d): 0.839

  MEDIAN:
    RANKING: 0.0539
    TPS:     0.0787
    Difference: +0.0248 (TPS higher Ã¢Å¡Â Ã¯Â¸Â)
    p-value: 2.4414e-04
    Significant: YES
    Effect size (Cohen's d): 0.787

  P95:
    RANKING: 0.0733
    TPS:     0.1210
    Difference: +0.0478 (TPS higher Ã¢Å¡Â Ã¯Â¸Â)
    p-value: 2.4414e-04
    Significant: YES
    Effect size (Cohen's d): 1.096

INTER-SPECIFIC:
  MEAN:
    RANKING: 0.0586
    TPS:     0.0837
    Difference: +0.0251 (TPS higher Ã¢Å¡Â Ã¯Â¸Â)
    p-value: 2.3474e-233
    Significant: YES
    Effect size (Cohen's d): 0.789

  MEDIAN:
    RANKING: 0.0569
    TPS:     0.0802
    Difference: +0.0234 (TPS higher Ã¢Å¡Â Ã¯Â¸Â)
    p-value: 2.3524e-233
    Significant: YES
    Effect size (Cohen's d): 0.734

  P95:
    RANKING: 0.0768
    TPS:     0.1200
    Difference: +0.0432 (TPS higher Ã¢Å¡Â Ã¯Â¸Â)
    p-value: 2.8642e-233
    Significant: YES
    Effect size (Cohen's d): 1.090


2. DISCRIMINATION POWER (Intra vs Inter Separation):
--------------------------------------------------------------------------------

RANKING METHOD:
  Separation: 0.0027 (4.9%)
  Cohen's d: 0.099 (VERY SMALL - no discrimination)
  Statistical significance: NO (pÃ¢â€°Â¥0.05)
  Tail analysis:
    Intra tail length (P95-mean): 0.0174
    Inter tail length (P95-mean): 0.0182
    Difference: +0.0008 (inter has longer tail Ã¢Å“â€œ)

TPS METHOD:
  Separation: 0.0013 (1.6%)
  Cohen's d: 0.038 (VERY SMALL - no discrimination)
  Statistical significance: NO (pÃ¢â€°Â¥0.05)
  Tail analysis:
    Intra tail length (P95-mean): 0.0387
    Inter tail length (P95-mean): 0.0363
    Difference: -0.0024 (WARNING: intra has longer tail!)

DISCRIMINATION COMPARISON:
  RANKING: sep=0.0027, d=0.099, AUROC=0.515, Cliff=0.030
  TPS:     sep=0.0013, d=0.038, AUROC=0.497, Cliff=-0.006
  Separation improvement: -0.0014 Ã¢Å“â€” RANKING has better separation
  Cohen's d improvement: -0.061 Ã¢Å“â€” RANKING has better effect size
  AUROC improvement: -0.018 Ã¢Å“â€” RANKING has better discrimination
  Cliff's Delta improvement: -0.036 Ã¢Å“â€” RANKING has better effect
  Tail separation improvement: -0.0031 Ã¢Å“â€” RANKING has better tail separation


3. DISTRIBUTION SHAPE ANALYSIS (Right-Hand Tail):
--------------------------------------------------------------------------------

RANKING METHOD:
  intra-specific:
    Tail length (P95-mean): 0.0174 Ã‚Â± 0.0120
    Skewness: 1.558
  inter-specific:
    Tail length (P95-mean): 0.0182 Ã‚Â± 0.0110
    Skewness: 1.474

TPS METHOD:
  intra-specific:
    Tail length (P95-mean): 0.0387 Ã‚Â± 0.0170
    Skewness: 0.732
  inter-specific:
    Tail length (P95-mean): 0.0363 Ã‚Â± 0.0145
    Skewness: 1.297


================================================================================
INTERPRETATION GUIDE
================================================================================

EXPECTED OUTCOMES FOR SUCCESSFUL MORPHOLOGY-AWARE METHOD:

1. SAME-SPECIMEN comparisons:
   - Should have LOWEST dissimilarity (near 0)
   - TPS may perform similarly or slightly better than RANKING

2. INTRA-SPECIFIC comparisons:
   - Should have LOW dissimilarity
   - TPS should ideally show LOWER values than RANKING
   - This demonstrates better recognition of morphological similarity

3. INTER-SPECIFIC comparisons:
   - Should have HIGHER dissimilarity than intra-specific
   - TPS may show similar or higher values than RANKING
   - Clear separation from intra-specific is key

METRICS:
  - MEAN: Average dissimilarity across all patches/cells
  - MEDIAN: Middle value (robust to outliers)
  - P95: 95th percentile (captures worst-case dissimilarity)

MEAN vs P95 INTERPRETATION:
  - Large gap (P95 >> Mean): High variability, some regions differ greatly
  - Small gap (P95 Ã¢â€°Ë† Mean): Uniform dissimilarity across specimen
  - TPS should ideally reduce the gap for true homologous regions

ADVANCED METRICS EXPLAINED:
--------------------------------------------------------------------------------
Ã¢â‚¬Â¢ Separation: Inter-mean minus Intra-mean (HIGHER is better)
Ã¢â‚¬Â¢ Cohen's d: Standardized effect size
    < 0.2: trivial, 0.2-0.5: small, 0.5-0.8: medium, > 0.8: large
Ã¢â‚¬Â¢ AUROC: Area Under ROC Curve (discrimination ability)
    0.5: random, 0.7-0.8: fair, 0.8-0.9: good, > 0.9: excellent
Ã¢â‚¬Â¢ Cliff's Delta: Non-parametric effect size (robust to outliers)
    < 0.147: negligible, 0.147-0.33: small, 0.33-0.474: medium, > 0.474: large
Ã¢â‚¬Â¢ Tail length: P95 minus Mean (measures right skew)
Ã¢â‚¬Â¢ Tail difference: Inter_tail - Intra_tail (POSITIVE means inter has longer tail)


================================================================================
FILES GENERATED
================================================================================

Detailed Statistics:
  Ã¢â‚¬Â¢ detailed_statistics_RANKING.csv
  Ã¢â‚¬Â¢ detailed_statistics_TPS.csv

Summary Statistics:
  Ã¢â‚¬Â¢ summary_statistics_BOTH_METHODS.csv
  Ã¢â‚¬Â¢ tail_metrics_distribution_shape.csv
  Ã¢â‚¬Â¢ method_comparison_statistics.csv
  Ã¢â‚¬Â¢ discrimination_analysis.csv (includes AUROC and Cliff's Delta)

Visualizations:
  Ã¢â‚¬Â¢ distributions_comparison_BOTH_METHODS.png
  Ã¢â‚¬Â¢ method_comparison_boxplots.png
  Ã¢â‚¬Â¢ paired_comparison_scatter.png
  Ã¢â‚¬Â¢ distribution_tail_analysis.png

Debugging Files (NEW!):
  Ã¢â‚¬Â¢ debugging_heatmap_IMAGE_comparison.png - Image-by-image heatmap
    (Labels: filename | species_name)
    (Lower triangle = RANKING, Upper triangle = TPS, Red boxes = intra-specific)
  Ã¢â‚¬Â¢ debugging_IMAGE_pairs_with_filenames.csv - All pairs with filenames
    (Use to verify which images are truly same species)
    (Check for tribe-level IDs like 'Colpopterini' being wrongly grouped!)

